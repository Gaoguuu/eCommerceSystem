{"remainingRequest":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\src\\views\\video\\VideoMark.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\src\\views\\video\\VideoMark.vue","mtime":1728976157745},{"path":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1728977241680},{"path":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\node_modules\\babel-loader\\lib\\index.js","mtime":1728977243261},{"path":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1728977241680},{"path":"D:\\projectWork\\thirdGrade\\econmic\\mrpSystem\\vue-admin-design\\node_modules\\vue-loader\\lib\\index.js","mtime":1728977244061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgSGludHMgZnJvbSAnQC9jb21wb25lbnRzL0hpbnRzJw0KaW1wb3J0IEVsZW1lbnREcnIgZnJvbSAnQC9jb21wb25lbnRzL0VsZW1lbnREcnInDQppbXBvcnQgSW1hZ2VSaWNoVGV4dCBmcm9tICdAL2NvbXBvbmVudHMvSW1hZ2VSaWNoVGV4dCcNCmltcG9ydCBUZXh0U2V0dGluZyBmcm9tICdAL2NvbXBvbmVudHMvVGV4dFNldHRpbmcnDQppbXBvcnQgVXBsb2FkSW1hZ2UgZnJvbSAnQC9jb21wb25lbnRzL1VwbG9hZEltYWdlJw0KaW1wb3J0IHsgY2FsY0ltYWdlU2l6ZSB9IGZyb20gJ0AvdXRpbHMnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ1ZpZGVvTWFyaycsDQogIGNvbXBvbmVudHM6IHsgSGludHMsIEVsZW1lbnREcnIsIEltYWdlUmljaFRleHQsIFRleHRTZXR0aW5nLCBVcGxvYWRJbWFnZSB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB2aWRlb1NyYzogJ2h0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9iYWltaW5neHVhbi9tZWRpYS1zdG9yZS92aWRlb3MvaG91bGFuZy5tcDQnLA0KICAgICAgZWxlbWVudHM6IFtdLCAvLyDlj6DliqDnu4Tku7bmlbDnu4QNCiAgICAgIGFjdGl2ZUVsZToge30sIC8vIOW9k+WJjeWbvueJh+S4iuiBmueEpueahOWPoOWKoOe7hOS7tg0KICAgICAgZWxlTnVtOiAwDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC8vIOmAieaLqeeahOaWh+acrA0KICAgIGFjdGl2ZUVsZVRleHQoKSB7DQogICAgICBsZXQgYWN0aXZlID0ge30NCiAgICAgIGlmICh0aGlzLmFjdGl2ZUVsZS50eXBlID09PSAndGV4dCcpIHsNCiAgICAgICAgYWN0aXZlID0gdGhpcy5hY3RpdmVFbGUNCiAgICAgIH0NCiAgICAgIHJldHVybiBhY3RpdmUNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5hZGRUZXh0KCkNCiAgICB0aGlzLmFkZEltYWdlKHsNCiAgICAgIGFjdGl2ZTogZmFsc2UsDQogICAgICBzcmM6ICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvYmFpbWluZ3h1YW4vbWVkaWEtc3RvcmUvaW1hZ2VzL2ltZzA2LmpwZycsDQogICAgICBzaXplOiA1MzI0OCwNCiAgICAgIHdpZHRoOiAxMzIsDQogICAgICBoZWlnaHQ6IDEzMg0KICAgIH0pDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDmi5bliqjlhYPntKDmiormn4QNCiAgICBkcmFnSGFuZGxlcyh0eXBlKSB7DQogICAgICBpZiAodHlwZSA9PT0gJ3RleHQnKSB7DQogICAgICAgIHJldHVybiBbJ2UnLCAndyddDQogICAgICB9DQogICAgfSwNCiAgICAvLyDlhYPntKDlsYLnuqfmjpLluo8NCiAgICBlbGVtZW50WkluZGV4KHR5cGUpIHsNCiAgICAgIGxldCB6SW5kZXggPSAxDQogICAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgICAgY2FzZSAndGV4dCc6DQogICAgICAgICAgekluZGV4ID0gMw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgJ2ltYWdlJzoNCiAgICAgICAgICB6SW5kZXggPSAyDQogICAgICAgICAgYnJlYWsNCiAgICAgIH0NCiAgICAgIHJldHVybiB7DQogICAgICAgIHpJbmRleDogekluZGV4DQogICAgICB9DQogICAgfSwNCiAgICAvLyDmt7vliqDmlofmnKwNCiAgICBhZGRUZXh0KCkgew0KICAgICAgY29uc3QgdGFnTnVtID0gKyt0aGlzLmVsZU51bQ0KICAgICAgY29uc3QgdGV4dCA9IHsNCiAgICAgICAgYWN0aXZlOiB0cnVlLA0KICAgICAgICB0ZXh0OiAn6K+36L6T5YWl5paH5pysJywNCiAgICAgICAgdHlwZTogJ3RleHQnLA0KICAgICAgICB0YWc6ICd0ZXh0XycgKyB0YWdOdW0sDQogICAgICAgIHg6IDMwMCwNCiAgICAgICAgeTogODAsDQogICAgICAgIHc6IDE4MCwNCiAgICAgICAgaDogMzYsDQogICAgICAgIHN0eWxlOiB7DQogICAgICAgICAgdGV4dEFsaWduOiAnbGVmdCcsDQogICAgICAgICAgbGluZUhlaWdodDogJzI0cHgnLA0KICAgICAgICAgIGZvbnRTaXplOiAnMjRweCcsDQogICAgICAgICAgZm9udEZhbWlseTogJ+W+rui9r+m7keS9kycsDQogICAgICAgICAgZm9udFdlaWdodDogNDAwLA0KICAgICAgICAgIGNvbG9yOiAnIzY4NzY4NCcsDQogICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzlhYzhkOCcsDQogICAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmxlbmd0aCA+IDQpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCflm77niYfkuIrmnIDlpJrlj6DliqA15Liq5YWD57Sg77yBJykNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZWxlbWVudHMucHVzaCh0ZXh0KQ0KICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZUVsZSh0ZXh0KQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5re75Yqg5Zu+54mHDQogICAgYWRkSW1hZ2UoaW1nT2JqKSB7DQogICAgICBjb25zdCB0YWdOdW0gPSArK3RoaXMuZWxlTnVtDQogICAgICBjb25zdCBpbWFnZSA9IHsNCiAgICAgICAgYWN0aXZlOiBpbWdPYmouYWN0aXZlLA0KICAgICAgICB0eXBlOiAnaW1hZ2UnLA0KICAgICAgICB0YWc6ICdpbWFnZV8nICsgdGFnTnVtLA0KICAgICAgICB4OiAzMjAsDQogICAgICAgIHk6IDI2MCwNCiAgICAgICAgdzogcGFyc2VJbnQoaW1nT2JqLndpZHRoKSwNCiAgICAgICAgaDogcGFyc2VJbnQoaW1nT2JqLmhlaWdodCksDQogICAgICAgIHNyYzogaW1nT2JqLnNyYywNCiAgICAgICAgc2l6ZTogaW1nT2JqLnNpemUNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmxlbmd0aCA+IDQpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCflm77niYfkuIrmnIDlpJrlj6DliqA15Liq5YWD57Sg77yBJykNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZWxlbWVudHMucHVzaChpbWFnZSkNCiAgICAgICAgaWYgKGltZ09iai5hY3RpdmUpIHsNCiAgICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZUVsZShpbWFnZSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5LiK5Lyg5Zu+54mH5oiQ5YqfDQogICAgaGFuZGxlQWRkSW1hZ2UoZGF0YSkgew0KICAgICAgY29uc3QgZGF0YVN0ckxlbiA9IGRhdGEucmVwbGFjZSgnZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwnLCAnJykubGVuZ3RoDQogICAgICBjb25zdCBkYXRhU2l6ZSA9IHBhcnNlSW50KGRhdGFTdHJMZW4gLSAoZGF0YVN0ckxlbiAvIDgpICogMikNCiAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpDQogICAgICBpbWcuc3JjID0gZGF0YQ0KICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHsNCiAgICAgICAgY29uc3QgaW1hZ2VTaXplID0gY2FsY0ltYWdlU2l6ZShpbWcud2lkdGgsIGltZy5oZWlnaHQsIHBhcnNlSW50KDg1MCAvIDQpLCBwYXJzZUludCg0NzggLyA0KSkNCiAgICAgICAgdGhpcy5hZGRJbWFnZSh7DQogICAgICAgICAgYWN0aXZlOiB0cnVlLA0KICAgICAgICAgIHNyYzogZGF0YSwNCiAgICAgICAgICBzaXplOiBkYXRhU2l6ZSwNCiAgICAgICAgICB3aWR0aDogaW1hZ2VTaXplLndpZHRoLA0KICAgICAgICAgIGhlaWdodDogaW1hZ2VTaXplLmhlaWdodA0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5pu05paw5b2T5YmN6YCJ5Lit55qE5YWD57SgDQogICAgdXBkYXRlQWN0aXZlRWxlKGVsZW1lbnQpIHsNCiAgICAgIHRoaXMuYWN0aXZlRWxlID0gZWxlbWVudA0KICAgIH0sDQogICAgLy8g5Yig6Zmk5Zu+54mH5LiK5b2T5YmN6YCJ5oup55qE5YWD57SgDQogICAgZGVsZXRlQWN0aXZlRWxlKCkgew0KICAgICAgY29uc3QgbmV3RWxlbWVudHMgPSB0aGlzLmVsZW1lbnRzLmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgcmV0dXJuIGl0ZW0udGFnICE9PSB0aGlzLmFjdGl2ZUVsZS50YWcNCiAgICAgIH0pDQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuZWxlbWVudHMgPSBuZXdFbGVtZW50cw0KICAgICAgfSkNCiAgICAgIHRoaXMudXBkYXRlQWN0aXZlRWxlKHt9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["VideoMark.vue"],"names":[],"mappings":";AAyDA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VideoMark.vue","sourceRoot":"src/views/video","sourcesContent":["<template>\r\n  <div class=\"video-mark-wrapper\">\r\n    <Hints>\r\n      <template slot=\"hintName\">视频水印</template>\r\n      <template slot=\"hintInfo\">\r\n        <p>基于VueDRR拖拽功能，在视频上通过叠加图片、文字等，实现视频添加水印的功能</p>\r\n        <p>VueDRR：基于vue-draggable-resizable的vue组件，可以实现拖动、拉伸和旋转功能</p>\r\n      </template>\r\n    </Hints>\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"16\">\r\n        <el-card shadow=\"always\">\r\n          <div slot=\"header\" class=\"title\">合成区域</div>\r\n          <div class=\"box-wrapper\">\r\n            <div class=\"drag-container\">\r\n              <video :src=\"videoSrc\" controls />\r\n              <ElementDrr\r\n                v-for=\"(item, index) in elements\"\r\n                :key=\"index\"\r\n                :element=\"item\"\r\n                :handles=\"dragHandles(item.type)\"\r\n                :style=\"elementZIndex(item.type)\"\r\n                @updateActiveEle=\"updateActiveEle\"\r\n              >\r\n                <!-- 图片 -->\r\n                <img v-if=\"item.type==='image'\" :src=\"item.src\" draggable=\"false\">\r\n                <!-- 文字 -->\r\n                <ImageRichText v-if=\"item.type === 'text'\" v-model=\"item.text\" :element=\"item\" :active-ele-text=\"activeEleText\" />\r\n              </ElementDrr>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-card shadow=\"always\">\r\n          <div slot=\"header\" class=\"title\">设置区域</div>\r\n          <div class=\"box-content\">\r\n            <el-form class=\"form-wrapper\" label-width=\"70px\">\r\n              <el-form-item label=\"添加文本\">\r\n                <el-button @click=\"addText\">添加文本</el-button>\r\n              </el-form-item>\r\n              <el-form-item label=\"添加图片\">\r\n                <UploadImage @on-success=\"handleAddImage\" />\r\n              </el-form-item>\r\n              <el-form-item label=\"删除元素\">\r\n                <el-button type=\"danger\" @click=\"deleteActiveEle\">删除元素</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n            <TextSetting v-if=\"activeEle.type === 'text'\" :active-ele-text=\"activeEleText\" />\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Hints from '@/components/Hints'\r\nimport ElementDrr from '@/components/ElementDrr'\r\nimport ImageRichText from '@/components/ImageRichText'\r\nimport TextSetting from '@/components/TextSetting'\r\nimport UploadImage from '@/components/UploadImage'\r\nimport { calcImageSize } from '@/utils'\r\n\r\nexport default {\r\n  name: 'VideoMark',\r\n  components: { Hints, ElementDrr, ImageRichText, TextSetting, UploadImage },\r\n  data() {\r\n    return {\r\n      videoSrc: 'https://cdn.jsdelivr.net/gh/baimingxuan/media-store/videos/houlang.mp4',\r\n      elements: [], // 叠加组件数组\r\n      activeEle: {}, // 当前图片上聚焦的叠加组件\r\n      eleNum: 0\r\n    }\r\n  },\r\n  computed: {\r\n    // 选择的文本\r\n    activeEleText() {\r\n      let active = {}\r\n      if (this.activeEle.type === 'text') {\r\n        active = this.activeEle\r\n      }\r\n      return active\r\n    }\r\n  },\r\n  created() {\r\n    this.addText()\r\n    this.addImage({\r\n      active: false,\r\n      src: 'https://cdn.jsdelivr.net/gh/baimingxuan/media-store/images/img06.jpg',\r\n      size: 53248,\r\n      width: 132,\r\n      height: 132\r\n    })\r\n  },\r\n  methods: {\r\n    // 拖动元素把柄\r\n    dragHandles(type) {\r\n      if (type === 'text') {\r\n        return ['e', 'w']\r\n      }\r\n    },\r\n    // 元素层级排序\r\n    elementZIndex(type) {\r\n      let zIndex = 1\r\n      switch (type) {\r\n        case 'text':\r\n          zIndex = 3\r\n          break\r\n        case 'image':\r\n          zIndex = 2\r\n          break\r\n      }\r\n      return {\r\n        zIndex: zIndex\r\n      }\r\n    },\r\n    // 添加文本\r\n    addText() {\r\n      const tagNum = ++this.eleNum\r\n      const text = {\r\n        active: true,\r\n        text: '请输入文本',\r\n        type: 'text',\r\n        tag: 'text_' + tagNum,\r\n        x: 300,\r\n        y: 80,\r\n        w: 180,\r\n        h: 36,\r\n        style: {\r\n          textAlign: 'left',\r\n          lineHeight: '24px',\r\n          fontSize: '24px',\r\n          fontFamily: '微软黑体',\r\n          fontWeight: 400,\r\n          color: '#687684',\r\n          backgroundColor: '#9ac8d8',\r\n          overflow: 'hidden'\r\n        }\r\n      }\r\n      if (this.elements.length > 4) {\r\n        this.$message.warning('图片上最多叠加5个元素！')\r\n      } else {\r\n        this.elements.push(text)\r\n        this.updateActiveEle(text)\r\n      }\r\n    },\r\n    // 添加图片\r\n    addImage(imgObj) {\r\n      const tagNum = ++this.eleNum\r\n      const image = {\r\n        active: imgObj.active,\r\n        type: 'image',\r\n        tag: 'image_' + tagNum,\r\n        x: 320,\r\n        y: 260,\r\n        w: parseInt(imgObj.width),\r\n        h: parseInt(imgObj.height),\r\n        src: imgObj.src,\r\n        size: imgObj.size\r\n      }\r\n      if (this.elements.length > 4) {\r\n        this.$message.warning('图片上最多叠加5个元素！')\r\n      } else {\r\n        this.elements.push(image)\r\n        if (imgObj.active) {\r\n          this.updateActiveEle(image)\r\n        }\r\n      }\r\n    },\r\n    // 上传图片成功\r\n    handleAddImage(data) {\r\n      const dataStrLen = data.replace('data:image/jpeg;base64,', '').length\r\n      const dataSize = parseInt(dataStrLen - (dataStrLen / 8) * 2)\r\n      const img = new Image()\r\n      img.src = data\r\n      img.onload = () => {\r\n        const imageSize = calcImageSize(img.width, img.height, parseInt(850 / 4), parseInt(478 / 4))\r\n        this.addImage({\r\n          active: true,\r\n          src: data,\r\n          size: dataSize,\r\n          width: imageSize.width,\r\n          height: imageSize.height\r\n        })\r\n      }\r\n    },\r\n    // 更新当前选中的元素\r\n    updateActiveEle(element) {\r\n      this.activeEle = element\r\n    },\r\n    // 删除图片上当前选择的元素\r\n    deleteActiveEle() {\r\n      const newElements = this.elements.filter(item => {\r\n        return item.tag !== this.activeEle.tag\r\n      })\r\n      this.$nextTick(() => {\r\n        this.elements = newElements\r\n      })\r\n      this.updateActiveEle({})\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.video-mark-wrapper {\r\n  .box-wrapper {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 550px;\r\n    overflow: hidden;\r\n    .drag-container {\r\n      position: relative;\r\n      width: 850px;\r\n      height: 478px;\r\n      video {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n      .z-drr-container {\r\n        border: 1px dashed transparent;\r\n        &.z-active {\r\n          border: 1px dashed #2e95ff;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .box-content {\r\n    height: 550px;\r\n    overflow: hidden;\r\n    .form-wrapper {\r\n      width: 300px;\r\n      margin: 50px auto 0;\r\n    }\r\n    .el-button {\r\n      width: 210px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}